{"id":"modules/download.js","dependencies":[{"name":"C:\\Users\\USER\\Documents\\hmti_genikos_fakelos\\erasmus\\new_forexp\\package.json","includedInParent":true,"mtime":1711506038961},{"name":"jquery","loc":{"line":1,"column":14,"index":14},"parent":"C:\\Users\\USER\\Documents\\hmti_genikos_fakelos\\erasmus\\new_forexp\\modules\\download.js","resolved":"C:\\Users\\USER\\Documents\\hmti_genikos_fakelos\\erasmus\\new_forexp\\node_modules\\jquery\\dist\\jquery.js"},{"name":"../data/config.json","loc":{"line":2,"column":19,"index":44},"parent":"C:\\Users\\USER\\Documents\\hmti_genikos_fakelos\\erasmus\\new_forexp\\modules\\download.js","resolved":"C:\\Users\\USER\\Documents\\hmti_genikos_fakelos\\erasmus\\new_forexp\\data\\config.json"},{"name":"../main","loc":{"line":3,"column":29,"index":97},"parent":"C:\\Users\\USER\\Documents\\hmti_genikos_fakelos\\erasmus\\new_forexp\\modules\\download.js","resolved":"C:\\Users\\USER\\Documents\\hmti_genikos_fakelos\\erasmus\\new_forexp\\main.js"},{"name":"mustache","loc":{"line":4,"column":23,"index":132},"parent":"C:\\Users\\USER\\Documents\\hmti_genikos_fakelos\\erasmus\\new_forexp\\modules\\download.js","resolved":"C:\\Users\\USER\\Documents\\hmti_genikos_fakelos\\erasmus\\new_forexp\\node_modules\\mustache\\mustache.js"},{"name":"./util","loc":{"line":5,"column":44,"index":188},"parent":"C:\\Users\\USER\\Documents\\hmti_genikos_fakelos\\erasmus\\new_forexp\\modules\\download.js","resolved":"C:\\Users\\USER\\Documents\\hmti_genikos_fakelos\\erasmus\\new_forexp\\modules\\util.js"},{"name":"../data/htmlTemplates","loc":{"line":6,"column":37,"index":236},"parent":"C:\\Users\\USER\\Documents\\hmti_genikos_fakelos\\erasmus\\new_forexp\\modules\\download.js","resolved":"C:\\Users\\USER\\Documents\\hmti_genikos_fakelos\\erasmus\\new_forexp\\data\\htmlTemplates.js"},{"name":"./grid.js","loc":{"line":7,"column":39,"index":301},"parent":"C:\\Users\\USER\\Documents\\hmti_genikos_fakelos\\erasmus\\new_forexp\\modules\\download.js","resolved":"C:\\Users\\USER\\Documents\\hmti_genikos_fakelos\\erasmus\\new_forexp\\modules\\grid.js"}],"generated":{"js":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.prepararDescarga = prepararDescarga;\nvar _jquery = _interopRequireDefault(require(\"jquery\"));\nvar _config = _interopRequireDefault(require(\"../data/config.json\"));\nvar _main = require(\"../main\");\nvar _mustache = require(\"mustache\");\nvar _util = require(\"./util\");\nvar _htmlTemplates = require(\"../data/htmlTemplates\");\nvar _grid = require(\"./grid.js\");\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nfunction prepararDescarga() {\n  // obtengo zoom del mapa\n  console.log(_main.Sesion.zoom);\n  var zoomCelda = _main.Sesion.zoom > _config.default.zMaxCelda ? _config.default.zMaxCelda : _main.Sesion.zoom;\n  console.log(zoomCelda);\n  // obtengo grid a partir del polígono\n  if (_main.Layers.editableLayer.getLayers().length == 0) return; // nada que hacer\t\n  var polygon = _main.Layers.editableLayer.getLayers()[0]; // sólo debería haber un polígono\n  var grid = (0, _grid.getGrid)(polygon.getBounds(), zoomCelda);\n  console.log(grid);\n  // preparo objeto plantilla para el modal\n  var gridBounds = (0, _grid.getGridBounds)(grid, zoomCelda);\n  var tobjbody = {\n    zoom: zoomCelda,\n    plotsAvailable: zoomCelda >= _config.default.zParcela\n  };\n\n  // // inicialización modal con petición de confirmación\n  // const htmlbody = Mustache.render(downloadTemplateBody, tobjbody);\n  // configurarModal( { static: true, vertcent: true}, \n  // \tgetLiteral(dict.downloadData), htmlbody, footerDescargaDatos);\t\t\n  // // muestro el modal\n  // const mimodal = new bootstrap.Modal(document.getElementById('mimodal'));\n  // mimodal.show();\n\n  // // listener al modal para que borre el polígono al cerrar\n  // document.getElementById('mimodal').addEventListener('hidden.bs.modal', event => {\n  // \tLayers.editableLayer.clearLayers();\n  // });\n\n  // // pongo listener a los checks de descarga para mensajillo y para habilitar el botón de descarga\n  // $('.check-download').on('change', function() {\n  // \tconst alguncheck = $('.check-download').is(':checked');\n  // \tif (alguncheck) {\n  // \t\t$('#downloadNothing').addClass(\"d-none\");\n  // \t\tconst algunradio = $('.downloadRadio').is(':checked');\n  // \t\t$('#downloadData').prop('disabled', !algunradio);\n  // \t}\n  // \telse {\n  // \t\t$('#downloadNothing').removeClass(\"d-none\");\n  // \t\t$('#downloadData').prop('disabled', true);\n  // \t}\n  // });\n\n  // // pongo listener al radio para habilitar el botón de descarga\n  // $('.downloadRadio').on('change', function() {\t\n  // \t$('#downloadNoFormat').addClass(\"d-none\");\n  // \tconst alguncheck = $('.check-download').is(':checked');\n  // \tif (alguncheck)\n  // \t\t$('#downloadData').prop('disabled', false);\n  // });\n\n  // // listener al botón de descarga\n  // $('#downloadData').click(function() {\n  // \t// miro qué cosas quiere descargar\n  // \tlet cosasDescargar = {\n  // \t\tplots: $('#checkPlots').is(':checked'),\n  // \t\ttrees: $('#checkTrees').is(':checked'),\n  // \t\tregions: $('#checkRegions').is(':checked'),\n  // \t\tpatches: $('#checkPatches').is(':checked')\n  // \t};\t\n  // \t// detecto el formato de descarga y preparo nombre del fichero\n  // \tlet format = \"GeoJSON\"; // valor por defecto\n  // \tif ($('#CSV').is(':checked'))\n  // \t\tformat = \"CSV\";\n  // \t// llamo a descargar los datos\n  // \t// descargarDatos(cosasDescargar, grid, zoomCelda, format, polygon);\n  // });\n}"},"sourceMaps":{"js":{"mappings":[{"generated":{"line":7,"column":0},"source":"modules/download.js","original":{"line":1,"column":0}},{"generated":{"line":7,"column":4},"source":"modules/download.js","original":{"line":1,"column":0},"name":"_jquery"},{"generated":{"line":7,"column":11},"source":"modules/download.js","original":{"line":1,"column":0}},{"generated":{"line":7,"column":14},"source":"modules/download.js","original":{"line":1,"column":0},"name":"_interopRequireDefault"},{"generated":{"line":7,"column":36},"source":"modules/download.js","original":{"line":1,"column":0}},{"generated":{"line":7,"column":37},"source":"modules/download.js","original":{"line":1,"column":0},"name":"require"},{"generated":{"line":7,"column":44},"source":"modules/download.js","original":{"line":1,"column":0}},{"generated":{"line":8,"column":0},"source":"modules/download.js","original":{"line":2,"column":0}},{"generated":{"line":8,"column":4},"source":"modules/download.js","original":{"line":2,"column":0},"name":"_config"},{"generated":{"line":8,"column":11},"source":"modules/download.js","original":{"line":2,"column":0}},{"generated":{"line":8,"column":14},"source":"modules/download.js","original":{"line":2,"column":0},"name":"_interopRequireDefault"},{"generated":{"line":8,"column":36},"source":"modules/download.js","original":{"line":2,"column":0}},{"generated":{"line":8,"column":37},"source":"modules/download.js","original":{"line":2,"column":0},"name":"require"},{"generated":{"line":8,"column":44},"source":"modules/download.js","original":{"line":2,"column":0}},{"generated":{"line":9,"column":0},"source":"modules/download.js","original":{"line":3,"column":0}},{"generated":{"line":9,"column":4},"source":"modules/download.js","original":{"line":3,"column":0},"name":"_main"},{"generated":{"line":9,"column":9},"source":"modules/download.js","original":{"line":3,"column":0}},{"generated":{"line":9,"column":12},"source":"modules/download.js","original":{"line":3,"column":0},"name":"require"},{"generated":{"line":9,"column":19},"source":"modules/download.js","original":{"line":3,"column":0}},{"generated":{"line":10,"column":0},"source":"modules/download.js","original":{"line":4,"column":0}},{"generated":{"line":10,"column":4},"source":"modules/download.js","original":{"line":4,"column":0},"name":"_mustache"},{"generated":{"line":10,"column":13},"source":"modules/download.js","original":{"line":4,"column":0}},{"generated":{"line":10,"column":16},"source":"modules/download.js","original":{"line":4,"column":0},"name":"require"},{"generated":{"line":10,"column":23},"source":"modules/download.js","original":{"line":4,"column":0}},{"generated":{"line":11,"column":0},"source":"modules/download.js","original":{"line":5,"column":0}},{"generated":{"line":11,"column":4},"source":"modules/download.js","original":{"line":5,"column":0},"name":"_util"},{"generated":{"line":11,"column":9},"source":"modules/download.js","original":{"line":5,"column":0}},{"generated":{"line":11,"column":12},"source":"modules/download.js","original":{"line":5,"column":0},"name":"require"},{"generated":{"line":11,"column":19},"source":"modules/download.js","original":{"line":5,"column":0}},{"generated":{"line":12,"column":0},"source":"modules/download.js","original":{"line":6,"column":0}},{"generated":{"line":12,"column":4},"source":"modules/download.js","original":{"line":6,"column":0},"name":"_htmlTemplates"},{"generated":{"line":12,"column":18},"source":"modules/download.js","original":{"line":6,"column":0}},{"generated":{"line":12,"column":21},"source":"modules/download.js","original":{"line":6,"column":0},"name":"require"},{"generated":{"line":12,"column":28},"source":"modules/download.js","original":{"line":6,"column":0}},{"generated":{"line":13,"column":0},"source":"modules/download.js","original":{"line":7,"column":0}},{"generated":{"line":13,"column":4},"source":"modules/download.js","original":{"line":7,"column":0},"name":"_grid"},{"generated":{"line":13,"column":9},"source":"modules/download.js","original":{"line":7,"column":0}},{"generated":{"line":13,"column":12},"source":"modules/download.js","original":{"line":7,"column":0},"name":"require"},{"generated":{"line":13,"column":19},"source":"modules/download.js","original":{"line":7,"column":0}},{"generated":{"line":14,"column":0},"source":"modules/download.js","original":{"line":7,"column":51}},{"generated":{"line":14,"column":9},"source":"modules/download.js","original":{"line":7,"column":51},"name":"_interopRequireDefault"},{"generated":{"line":14,"column":32},"source":"modules/download.js","original":{"line":7,"column":51},"name":"obj"},{"generated":{"line":14,"column":35},"source":"modules/download.js","original":{"line":7,"column":51}},{"generated":{"line":14,"column":46},"source":"modules/download.js","original":{"line":7,"column":51},"name":"obj"},{"generated":{"line":14,"column":49},"source":"modules/download.js","original":{"line":7,"column":51}},{"generated":{"line":14,"column":53},"source":"modules/download.js","original":{"line":7,"column":51},"name":"obj"},{"generated":{"line":14,"column":56},"source":"modules/download.js","original":{"line":7,"column":51}},{"generated":{"line":14,"column":57},"source":"modules/download.js","original":{"line":7,"column":51},"name":"__esModule"},{"generated":{"line":14,"column":67},"source":"modules/download.js","original":{"line":7,"column":51}},{"generated":{"line":14,"column":70},"source":"modules/download.js","original":{"line":7,"column":51},"name":"obj"},{"generated":{"line":14,"column":73},"source":"modules/download.js","original":{"line":7,"column":51}},{"generated":{"line":14,"column":78},"source":"modules/download.js","original":{"line":7,"column":51},"name":"default"},{"generated":{"line":14,"column":85},"source":"modules/download.js","original":{"line":7,"column":51}},{"generated":{"line":14,"column":87},"source":"modules/download.js","original":{"line":7,"column":51},"name":"obj"},{"generated":{"line":14,"column":90},"source":"modules/download.js","original":{"line":7,"column":51}},{"generated":{"line":15,"column":0},"source":"modules/download.js","original":{"line":9,"column":0}},{"generated":{"line":15,"column":9},"source":"modules/download.js","original":{"line":9,"column":9},"name":"prepararDescarga"},{"generated":{"line":15,"column":25},"source":"modules/download.js","original":{"line":9,"column":25},"name":"prepararDescarga"},{"generated":{"line":15,"column":26},"source":"modules/download.js","original":{"line":9,"column":25}},{"generated":{"line":15,"column":28},"source":"modules/download.js","original":{"line":9,"column":28}},{"generated":{"line":16,"column":2},"source":"modules/download.js","original":{"line":10,"column":1}},{"generated":{"line":17,"column":2},"source":"modules/download.js","original":{"line":11,"column":4},"name":"console"},{"generated":{"line":17,"column":9},"source":"modules/download.js","original":{"line":11,"column":11}},{"generated":{"line":17,"column":10},"source":"modules/download.js","original":{"line":11,"column":12},"name":"log"},{"generated":{"line":17,"column":13},"source":"modules/download.js","original":{"line":11,"column":15}},{"generated":{"line":17,"column":14},"source":"modules/download.js","original":{"line":11,"column":16},"name":"Sesion"},{"generated":{"line":17,"column":26},"source":"modules/download.js","original":{"line":11,"column":22}},{"generated":{"line":17,"column":27},"source":"modules/download.js","original":{"line":11,"column":23},"name":"zoom"},{"generated":{"line":17,"column":31},"source":"modules/download.js","original":{"line":11,"column":27}},{"generated":{"line":17,"column":32},"source":"modules/download.js","original":{"line":11,"column":28}},{"generated":{"line":18,"column":2},"source":"modules/download.js","original":{"line":12,"column":1}},{"generated":{"line":18,"column":6},"source":"modules/download.js","original":{"line":12,"column":7},"name":"zoomCelda"},{"generated":{"line":18,"column":15},"source":"modules/download.js","original":{"line":12,"column":16}},{"generated":{"line":18,"column":18},"source":"modules/download.js","original":{"line":12,"column":19},"name":"Sesion"},{"generated":{"line":18,"column":30},"source":"modules/download.js","original":{"line":12,"column":25}},{"generated":{"line":18,"column":31},"source":"modules/download.js","original":{"line":12,"column":26},"name":"zoom"},{"generated":{"line":18,"column":35},"source":"modules/download.js","original":{"line":12,"column":30}},{"generated":{"line":18,"column":38},"source":"modules/download.js","original":{"line":12,"column":33},"name":"config"},{"generated":{"line":18,"column":53},"source":"modules/download.js","original":{"line":12,"column":39}},{"generated":{"line":18,"column":54},"source":"modules/download.js","original":{"line":12,"column":40},"name":"zMaxCelda"},{"generated":{"line":18,"column":63},"source":"modules/download.js","original":{"line":12,"column":49}},{"generated":{"line":18,"column":66},"source":"modules/download.js","original":{"line":12,"column":51},"name":"config"},{"generated":{"line":18,"column":81},"source":"modules/download.js","original":{"line":12,"column":57}},{"generated":{"line":18,"column":82},"source":"modules/download.js","original":{"line":12,"column":58},"name":"zMaxCelda"},{"generated":{"line":18,"column":91},"source":"modules/download.js","original":{"line":12,"column":67}},{"generated":{"line":18,"column":94},"source":"modules/download.js","original":{"line":12,"column":70},"name":"Sesion"},{"generated":{"line":18,"column":106},"source":"modules/download.js","original":{"line":12,"column":76}},{"generated":{"line":18,"column":107},"source":"modules/download.js","original":{"line":12,"column":77},"name":"zoom"},{"generated":{"line":18,"column":111},"source":"modules/download.js","original":{"line":12,"column":81}},{"generated":{"line":19,"column":2},"source":"modules/download.js","original":{"line":13,"column":4},"name":"console"},{"generated":{"line":19,"column":9},"source":"modules/download.js","original":{"line":13,"column":11}},{"generated":{"line":19,"column":10},"source":"modules/download.js","original":{"line":13,"column":12},"name":"log"},{"generated":{"line":19,"column":13},"source":"modules/download.js","original":{"line":13,"column":15}},{"generated":{"line":19,"column":14},"source":"modules/download.js","original":{"line":13,"column":16},"name":"zoomCelda"},{"generated":{"line":19,"column":23},"source":"modules/download.js","original":{"line":13,"column":25}},{"generated":{"line":19,"column":24},"source":"modules/download.js","original":{"line":13,"column":26}},{"generated":{"line":20,"column":2},"source":"modules/download.js","original":{"line":14,"column":1}},{"generated":{"line":21,"column":2},"source":"modules/download.js","original":{"line":15,"column":1}},{"generated":{"line":21,"column":6},"source":"modules/download.js","original":{"line":15,"column":5},"name":"Layers"},{"generated":{"line":21,"column":18},"source":"modules/download.js","original":{"line":15,"column":11}},{"generated":{"line":21,"column":19},"source":"modules/download.js","original":{"line":15,"column":12},"name":"editableLayer"},{"generated":{"line":21,"column":32},"source":"modules/download.js","original":{"line":15,"column":25}},{"generated":{"line":21,"column":33},"source":"modules/download.js","original":{"line":15,"column":26},"name":"getLayers"},{"generated":{"line":21,"column":42},"source":"modules/download.js","original":{"line":15,"column":35}},{"generated":{"line":21,"column":43},"source":"modules/download.js","original":{"line":15,"column":36}},{"generated":{"line":21,"column":44},"source":"modules/download.js","original":{"line":15,"column":37}},{"generated":{"line":21,"column":45},"source":"modules/download.js","original":{"line":15,"column":38},"name":"length"},{"generated":{"line":21,"column":51},"source":"modules/download.js","original":{"line":15,"column":44}},{"generated":{"line":21,"column":55},"source":"modules/download.js","original":{"line":15,"column":48}},{"generated":{"line":21,"column":56},"source":"modules/download.js","original":{"line":15,"column":49}},{"generated":{"line":21,"column":58},"source":"modules/download.js","original":{"line":16,"column":2}},{"generated":{"line":21,"column":65},"source":"modules/download.js","original":{"line":16,"column":9}},{"generated":{"line":21,"column":66},"source":"modules/download.js","original":{"line":16,"column":10}},{"generated":{"line":22,"column":2},"source":"modules/download.js","original":{"line":17,"column":1}},{"generated":{"line":22,"column":6},"source":"modules/download.js","original":{"line":17,"column":7},"name":"polygon"},{"generated":{"line":22,"column":13},"source":"modules/download.js","original":{"line":17,"column":14}},{"generated":{"line":22,"column":16},"source":"modules/download.js","original":{"line":17,"column":17},"name":"Layers"},{"generated":{"line":22,"column":28},"source":"modules/download.js","original":{"line":17,"column":23}},{"generated":{"line":22,"column":29},"source":"modules/download.js","original":{"line":17,"column":24},"name":"editableLayer"},{"generated":{"line":22,"column":42},"source":"modules/download.js","original":{"line":17,"column":37}},{"generated":{"line":22,"column":43},"source":"modules/download.js","original":{"line":17,"column":38},"name":"getLayers"},{"generated":{"line":22,"column":52},"source":"modules/download.js","original":{"line":17,"column":47}},{"generated":{"line":22,"column":53},"source":"modules/download.js","original":{"line":17,"column":48}},{"generated":{"line":22,"column":54},"source":"modules/download.js","original":{"line":17,"column":49}},{"generated":{"line":22,"column":55},"source":"modules/download.js","original":{"line":17,"column":50}},{"generated":{"line":22,"column":56},"source":"modules/download.js","original":{"line":17,"column":51}},{"generated":{"line":22,"column":57},"source":"modules/download.js","original":{"line":17,"column":52}},{"generated":{"line":22,"column":58},"source":"modules/download.js","original":{"line":17,"column":53}},{"generated":{"line":22,"column":59},"source":"modules/download.js","original":{"line":17,"column":54}},{"generated":{"line":23,"column":2},"source":"modules/download.js","original":{"line":18,"column":1}},{"generated":{"line":23,"column":6},"source":"modules/download.js","original":{"line":18,"column":7},"name":"grid"},{"generated":{"line":23,"column":10},"source":"modules/download.js","original":{"line":18,"column":11}},{"generated":{"line":23,"column":13},"source":"modules/download.js","original":{"line":18,"column":14}},{"generated":{"line":23,"column":17},"source":"modules/download.js","original":{"line":18,"column":14},"name":"getGrid"},{"generated":{"line":23,"column":30},"source":"modules/download.js","original":{"line":18,"column":21}},{"generated":{"line":23,"column":32},"source":"modules/download.js","original":{"line":18,"column":22},"name":"polygon"},{"generated":{"line":23,"column":39},"source":"modules/download.js","original":{"line":18,"column":29}},{"generated":{"line":23,"column":40},"source":"modules/download.js","original":{"line":18,"column":30},"name":"getBounds"},{"generated":{"line":23,"column":49},"source":"modules/download.js","original":{"line":18,"column":39}},{"generated":{"line":23,"column":50},"source":"modules/download.js","original":{"line":18,"column":40}},{"generated":{"line":23,"column":51},"source":"modules/download.js","original":{"line":18,"column":41}},{"generated":{"line":23,"column":53},"source":"modules/download.js","original":{"line":18,"column":43},"name":"zoomCelda"},{"generated":{"line":23,"column":62},"source":"modules/download.js","original":{"line":18,"column":52}},{"generated":{"line":23,"column":63},"source":"modules/download.js","original":{"line":18,"column":53}},{"generated":{"line":24,"column":2},"source":"modules/download.js","original":{"line":20,"column":4},"name":"console"},{"generated":{"line":24,"column":9},"source":"modules/download.js","original":{"line":20,"column":11}},{"generated":{"line":24,"column":10},"source":"modules/download.js","original":{"line":20,"column":12},"name":"log"},{"generated":{"line":24,"column":13},"source":"modules/download.js","original":{"line":20,"column":15}},{"generated":{"line":24,"column":14},"source":"modules/download.js","original":{"line":20,"column":16},"name":"grid"},{"generated":{"line":24,"column":18},"source":"modules/download.js","original":{"line":20,"column":20}},{"generated":{"line":24,"column":19},"source":"modules/download.js","original":{"line":20,"column":21}},{"generated":{"line":25,"column":2},"source":"modules/download.js","original":{"line":21,"column":1}},{"generated":{"line":26,"column":2},"source":"modules/download.js","original":{"line":22,"column":1}},{"generated":{"line":26,"column":6},"source":"modules/download.js","original":{"line":22,"column":7},"name":"gridBounds"},{"generated":{"line":26,"column":16},"source":"modules/download.js","original":{"line":22,"column":17}},{"generated":{"line":26,"column":19},"source":"modules/download.js","original":{"line":22,"column":20}},{"generated":{"line":26,"column":23},"source":"modules/download.js","original":{"line":22,"column":20},"name":"getGridBounds"},{"generated":{"line":26,"column":42},"source":"modules/download.js","original":{"line":22,"column":33}},{"generated":{"line":26,"column":44},"source":"modules/download.js","original":{"line":22,"column":34},"name":"grid"},{"generated":{"line":26,"column":48},"source":"modules/download.js","original":{"line":22,"column":38}},{"generated":{"line":26,"column":50},"source":"modules/download.js","original":{"line":22,"column":40},"name":"zoomCelda"},{"generated":{"line":26,"column":59},"source":"modules/download.js","original":{"line":22,"column":49}},{"generated":{"line":26,"column":60},"source":"modules/download.js","original":{"line":22,"column":50}},{"generated":{"line":27,"column":2},"source":"modules/download.js","original":{"line":23,"column":1}},{"generated":{"line":27,"column":6},"source":"modules/download.js","original":{"line":23,"column":7},"name":"tobjbody"},{"generated":{"line":27,"column":14},"source":"modules/download.js","original":{"line":23,"column":15}},{"generated":{"line":27,"column":17},"source":"modules/download.js","original":{"line":23,"column":18}},{"generated":{"line":28,"column":4},"source":"modules/download.js","original":{"line":24,"column":2},"name":"zoom"},{"generated":{"line":28,"column":8},"source":"modules/download.js","original":{"line":24,"column":6}},{"generated":{"line":28,"column":10},"source":"modules/download.js","original":{"line":24,"column":8},"name":"zoomCelda"},{"generated":{"line":28,"column":19},"source":"modules/download.js","original":{"line":24,"column":17}},{"generated":{"line":29,"column":4},"source":"modules/download.js","original":{"line":25,"column":2},"name":"plotsAvailable"},{"generated":{"line":29,"column":18},"source":"modules/download.js","original":{"line":25,"column":16}},{"generated":{"line":29,"column":20},"source":"modules/download.js","original":{"line":25,"column":18},"name":"zoomCelda"},{"generated":{"line":29,"column":29},"source":"modules/download.js","original":{"line":25,"column":27}},{"generated":{"line":29,"column":33},"source":"modules/download.js","original":{"line":25,"column":31},"name":"config"},{"generated":{"line":29,"column":48},"source":"modules/download.js","original":{"line":25,"column":37}},{"generated":{"line":29,"column":49},"source":"modules/download.js","original":{"line":25,"column":38},"name":"zParcela"},{"generated":{"line":30,"column":2},"source":"modules/download.js","original":{"line":26,"column":1}},{"generated":{"line":30,"column":3},"source":"modules/download.js","original":{"line":26,"column":2}},{"generated":{"line":32,"column":2},"source":"modules/download.js","original":{"line":28,"column":1}},{"generated":{"line":33,"column":2},"source":"modules/download.js","original":{"line":29,"column":1}},{"generated":{"line":34,"column":2},"source":"modules/download.js","original":{"line":30,"column":1}},{"generated":{"line":35,"column":2},"source":"modules/download.js","original":{"line":31,"column":1}},{"generated":{"line":36,"column":2},"source":"modules/download.js","original":{"line":32,"column":1}},{"generated":{"line":37,"column":2},"source":"modules/download.js","original":{"line":33,"column":1}},{"generated":{"line":38,"column":2},"source":"modules/download.js","original":{"line":34,"column":1}},{"generated":{"line":40,"column":2},"source":"modules/download.js","original":{"line":36,"column":1}},{"generated":{"line":41,"column":2},"source":"modules/download.js","original":{"line":37,"column":1}},{"generated":{"line":42,"column":2},"source":"modules/download.js","original":{"line":38,"column":2}},{"generated":{"line":43,"column":2},"source":"modules/download.js","original":{"line":39,"column":1}},{"generated":{"line":45,"column":2},"source":"modules/download.js","original":{"line":41,"column":1}},{"generated":{"line":46,"column":2},"source":"modules/download.js","original":{"line":42,"column":1}},{"generated":{"line":47,"column":2},"source":"modules/download.js","original":{"line":43,"column":1}},{"generated":{"line":48,"column":2},"source":"modules/download.js","original":{"line":44,"column":1}},{"generated":{"line":49,"column":2},"source":"modules/download.js","original":{"line":45,"column":1}},{"generated":{"line":50,"column":2},"source":"modules/download.js","original":{"line":46,"column":1}},{"generated":{"line":51,"column":2},"source":"modules/download.js","original":{"line":47,"column":1}},{"generated":{"line":52,"column":2},"source":"modules/download.js","original":{"line":48,"column":1}},{"generated":{"line":53,"column":2},"source":"modules/download.js","original":{"line":49,"column":1}},{"generated":{"line":54,"column":2},"source":"modules/download.js","original":{"line":50,"column":1}},{"generated":{"line":55,"column":2},"source":"modules/download.js","original":{"line":51,"column":1}},{"generated":{"line":56,"column":2},"source":"modules/download.js","original":{"line":52,"column":1}},{"generated":{"line":57,"column":2},"source":"modules/download.js","original":{"line":53,"column":1}},{"generated":{"line":59,"column":2},"source":"modules/download.js","original":{"line":55,"column":1}},{"generated":{"line":60,"column":2},"source":"modules/download.js","original":{"line":56,"column":1}},{"generated":{"line":61,"column":2},"source":"modules/download.js","original":{"line":57,"column":1}},{"generated":{"line":62,"column":2},"source":"modules/download.js","original":{"line":58,"column":1}},{"generated":{"line":63,"column":2},"source":"modules/download.js","original":{"line":59,"column":1}},{"generated":{"line":64,"column":2},"source":"modules/download.js","original":{"line":60,"column":1}},{"generated":{"line":65,"column":2},"source":"modules/download.js","original":{"line":61,"column":1}},{"generated":{"line":67,"column":2},"source":"modules/download.js","original":{"line":63,"column":1}},{"generated":{"line":68,"column":2},"source":"modules/download.js","original":{"line":64,"column":1}},{"generated":{"line":69,"column":2},"source":"modules/download.js","original":{"line":65,"column":1}},{"generated":{"line":70,"column":2},"source":"modules/download.js","original":{"line":66,"column":1}},{"generated":{"line":71,"column":2},"source":"modules/download.js","original":{"line":67,"column":1}},{"generated":{"line":72,"column":2},"source":"modules/download.js","original":{"line":68,"column":1}},{"generated":{"line":73,"column":2},"source":"modules/download.js","original":{"line":69,"column":1}},{"generated":{"line":74,"column":2},"source":"modules/download.js","original":{"line":70,"column":1}},{"generated":{"line":75,"column":2},"source":"modules/download.js","original":{"line":71,"column":1}},{"generated":{"line":76,"column":2},"source":"modules/download.js","original":{"line":72,"column":1}},{"generated":{"line":77,"column":2},"source":"modules/download.js","original":{"line":73,"column":1}},{"generated":{"line":78,"column":2},"source":"modules/download.js","original":{"line":74,"column":1}},{"generated":{"line":79,"column":2},"source":"modules/download.js","original":{"line":75,"column":1}},{"generated":{"line":80,"column":2},"source":"modules/download.js","original":{"line":76,"column":1}},{"generated":{"line":81,"column":2},"source":"modules/download.js","original":{"line":77,"column":1}},{"generated":{"line":82,"column":2},"source":"modules/download.js","original":{"line":78,"column":1}},{"generated":{"line":83,"column":0},"source":"modules/download.js","original":{"line":79,"column":0}}],"sources":{"modules/download.js":"import $ from \"jquery\";\r\nimport config from '../data/config.json';\r\nimport {Sesion, Layers} from \"../main\";\r\nimport {Mustache} from 'mustache'\r\nimport { getLiteral, configurarModal } from \"./util\";\r\nimport { downloadTemplateBody } from \"../data/htmlTemplates\";\r\nimport { getGrid, getGridBounds } from './grid.js';\r\n\r\nfunction prepararDescarga() {\r\n\t// obtengo zoom del mapa\r\n    console.log(Sesion.zoom)\r\n\tconst zoomCelda = Sesion.zoom > config.zMaxCelda? config.zMaxCelda : Sesion.zoom;\r\n    console.log(zoomCelda);\r\n\t// obtengo grid a partir del polígono\r\n\tif (Layers.editableLayer.getLayers().length == 0)\r\n\t\treturn; // nada que hacer\t\r\n\tconst polygon = Layers.editableLayer.getLayers()[0]; // sólo debería haber un polígono\r\n\tconst grid = getGrid(polygon.getBounds(), zoomCelda);\r\n\t\r\n    console.log(grid);\r\n\t// preparo objeto plantilla para el modal\r\n\tconst gridBounds = getGridBounds(grid, zoomCelda);\r\n\tconst tobjbody = {\r\n\t\tzoom: zoomCelda,\r\n\t\tplotsAvailable: zoomCelda >= config.zParcela\r\n\t};\r\n\t\r\n\t// // inicialización modal con petición de confirmación\r\n\t// const htmlbody = Mustache.render(downloadTemplateBody, tobjbody);\r\n\t// configurarModal( { static: true, vertcent: true}, \r\n\t// \tgetLiteral(dict.downloadData), htmlbody, footerDescargaDatos);\t\t\r\n\t// // muestro el modal\r\n\t// const mimodal = new bootstrap.Modal(document.getElementById('mimodal'));\r\n\t// mimodal.show();\r\n\t\r\n\t// // listener al modal para que borre el polígono al cerrar\r\n\t// document.getElementById('mimodal').addEventListener('hidden.bs.modal', event => {\r\n \t// \tLayers.editableLayer.clearLayers();\r\n\t// });\r\n\t\r\n\t// // pongo listener a los checks de descarga para mensajillo y para habilitar el botón de descarga\r\n\t// $('.check-download').on('change', function() {\r\n\t// \tconst alguncheck = $('.check-download').is(':checked');\r\n\t// \tif (alguncheck) {\r\n\t// \t\t$('#downloadNothing').addClass(\"d-none\");\r\n\t// \t\tconst algunradio = $('.downloadRadio').is(':checked');\r\n\t// \t\t$('#downloadData').prop('disabled', !algunradio);\r\n\t// \t}\r\n\t// \telse {\r\n\t// \t\t$('#downloadNothing').removeClass(\"d-none\");\r\n\t// \t\t$('#downloadData').prop('disabled', true);\r\n\t// \t}\r\n\t// });\r\n\t\r\n\t// // pongo listener al radio para habilitar el botón de descarga\r\n\t// $('.downloadRadio').on('change', function() {\t\r\n\t// \t$('#downloadNoFormat').addClass(\"d-none\");\r\n\t// \tconst alguncheck = $('.check-download').is(':checked');\r\n\t// \tif (alguncheck)\r\n\t// \t\t$('#downloadData').prop('disabled', false);\r\n\t// });\r\n\t\r\n\t// // listener al botón de descarga\r\n\t// $('#downloadData').click(function() {\r\n\t// \t// miro qué cosas quiere descargar\r\n\t// \tlet cosasDescargar = {\r\n\t// \t\tplots: $('#checkPlots').is(':checked'),\r\n\t// \t\ttrees: $('#checkTrees').is(':checked'),\r\n\t// \t\tregions: $('#checkRegions').is(':checked'),\r\n\t// \t\tpatches: $('#checkPatches').is(':checked')\r\n\t// \t};\t\r\n\t// \t// detecto el formato de descarga y preparo nombre del fichero\r\n\t// \tlet format = \"GeoJSON\"; // valor por defecto\r\n\t// \tif ($('#CSV').is(':checked'))\r\n\t// \t\tformat = \"CSV\";\r\n\t// \t// llamo a descargar los datos\r\n\t// \t// descargarDatos(cosasDescargar, grid, zoomCelda, format, polygon);\r\n\t// });\r\n}\r\n\r\nexport {prepararDescarga}"},"lineCount":null}},"error":null,"hash":"452b5d2423faa8b4481ce244be6cc89c","cacheData":{"env":{}}}